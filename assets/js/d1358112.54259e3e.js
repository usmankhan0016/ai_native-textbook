"use strict";(self.webpackChunkphysical_ai_humanoid_robotics_textbook=self.webpackChunkphysical_ai_humanoid_robotics_textbook||[]).push([[2906],{5634:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"module-1/chapter-2-ros2-architecture","title":"Chapter 2: ROS 2 Architecture","description":"Learning Objectives","source":"@site/docs/module-1/chapter-2-ros2-architecture.md","sourceDirName":"module-1","slug":"/module-1/chapter-2-ros2-architecture","permalink":"/ai_native-textbook/docs/module-1/chapter-2-ros2-architecture","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"ROS2","permalink":"/ai_native-textbook/docs/tags/ros-2"},{"inline":true,"label":"Nodes","permalink":"/ai_native-textbook/docs/tags/nodes"},{"inline":true,"label":"Topics","permalink":"/ai_native-textbook/docs/tags/topics"},{"inline":true,"label":"Services","permalink":"/ai_native-textbook/docs/tags/services"},{"inline":true,"label":"Actions","permalink":"/ai_native-textbook/docs/tags/actions"},{"inline":true,"label":"QoS","permalink":"/ai_native-textbook/docs/tags/qo-s"},{"inline":true,"label":"Week3","permalink":"/ai_native-textbook/docs/tags/week-3"},{"inline":true,"label":"Week4","permalink":"/ai_native-textbook/docs/tags/week-4"}],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"sidebar_label":"Ch2: Architecture","title":"Chapter 2: ROS 2 Architecture","tags":["ROS2","Nodes","Topics","Services","Actions","QoS","Week3","Week4"],"difficulty":"Beginner","module":1,"week":"3-4","prerequisites":["Chapter 1","Python basics","ROS 2 Humble installed"],"estimated_time":"3-4 hours","topics":["Nodes","Topics","Services","Actions","QoS policies","Message types"]},"sidebar":"tutorialSidebar","previous":{"title":"Ch1: Introduction","permalink":"/ai_native-textbook/docs/module-1/chapter-1-introduction-to-ros2"},"next":{"title":"Chapter 3: Packages, Launch Files, and Parameters","permalink":"/ai_native-textbook/docs/module-1/chapter-3-ros2-packages-launch"}}');var r=s(4848),t=s(8453);const l={sidebar_position:3,sidebar_label:"Ch2: Architecture",title:"Chapter 2: ROS 2 Architecture",tags:["ROS2","Nodes","Topics","Services","Actions","QoS","Week3","Week4"],difficulty:"Beginner",module:1,week:"3-4",prerequisites:["Chapter 1","Python basics","ROS 2 Humble installed"],estimated_time:"3-4 hours",topics:["Nodes","Topics","Services","Actions","QoS policies","Message types"]},o="Chapter 2: ROS 2 Architecture",c={},a=[{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"Key Concepts",id:"key-concepts",level:2},{value:"ROS 2 Graph Architecture",id:"ros-2-graph-architecture",level:2},{value:"Node Lifecycle",id:"node-lifecycle",level:2},{value:"Hands-On Tutorial: Minimal Node",id:"hands-on-tutorial-minimal-node",level:2},{value:"Hands-On Tutorial: Talker/Listener Pair",id:"hands-on-tutorial-talkerlistener-pair",level:2},{value:"Publisher (Talker)",id:"publisher-talker",level:3},{value:"Subscriber (Listener)",id:"subscriber-listener",level:3},{value:"Quality of Service (QoS) Policies",id:"quality-of-service-qos-policies",level:2},{value:"Key QoS Settings",id:"key-qos-settings",level:3},{value:"Example: Configuring QoS",id:"example-configuring-qos",level:3},{value:"Topics vs Services vs Actions: When to Use What?",id:"topics-vs-services-vs-actions-when-to-use-what",level:2},{value:"Hands-On Tutorial: Service Server/Client",id:"hands-on-tutorial-service-serverclient",level:2},{value:"Service Server",id:"service-server",level:3},{value:"Service Client",id:"service-client",level:3},{value:"Hands-On Tutorial: Action Server/Client",id:"hands-on-tutorial-action-serverclient",level:2},{value:"Action Server",id:"action-server",level:3},{value:"Action Client",id:"action-client",level:3},{value:"Common Message Types",id:"common-message-types",level:2},{value:"Key Message Packages for Humanoids",id:"key-message-packages-for-humanoids",level:3},{value:"Communication Patterns Comparison",id:"communication-patterns-comparison",level:2},{value:"End-of-Chapter Exercises",id:"end-of-chapter-exercises",level:2},{value:"Exercise 1: Temperature Monitor (Easy)",id:"exercise-1-temperature-monitor-easy",level:3},{value:"Exercise 2: Emergency Stop Subscriber (Easy)",id:"exercise-2-emergency-stop-subscriber-easy",level:3},{value:"Exercise 3: String Reversal Service (Medium)",id:"exercise-3-string-reversal-service-medium",level:3},{value:"Exercise 4: Countdown Action (Medium)",id:"exercise-4-countdown-action-medium",level:3},{value:"Exercise 5: Multi-Node Humanoid System (Hard)",id:"exercise-5-multi-node-humanoid-system-hard",level:3},{value:"Exercise 6: QoS Experiment (Medium)",id:"exercise-6-qos-experiment-medium",level:3},{value:"Capstone Integration",id:"capstone-integration",level:2},{value:"Summary",id:"summary",level:2},{value:"What&#39;s Next?",id:"whats-next",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"chapter-2-ros-2-architecture",children:"Chapter 2: ROS 2 Architecture"})}),"\n",(0,r.jsx)(n.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,r.jsx)(n.p,{children:"After completing this chapter, you will be able to:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Create"})," ROS 2 nodes in Python using the rclpy library"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Implement"})," publishers and subscribers for topic-based communication"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Build"})," service servers and clients for request-response patterns"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Develop"})," action servers and clients for long-running tasks with feedback"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Configure"})," Quality of Service (QoS) policies for reliable robotics applications"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Select"})," appropriate communication patterns (topics vs services vs actions) for different robotics scenarios"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"key-concepts",children:"Key Concepts"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Node"}),": An independent process that performs computation. Nodes are the building blocks of ROS 2 systems."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Topic"}),": A named bus over which nodes exchange messages via publish-subscribe pattern. One-to-many communication."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Service"}),": Synchronous request-response communication between a client and server. One-to-one, blocking."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Action"}),": Asynchronous goal-oriented communication with feedback and cancellation. For long-running tasks."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Quality of Service (QoS)"}),": Policies that control message delivery guarantees (reliability, durability, history)."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Message Types"}),": Standardized data structures (",(0,r.jsx)(n.code,{children:"sensor_msgs"}),", ",(0,r.jsx)(n.code,{children:"geometry_msgs"}),") for inter-node communication."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"ros-2-graph-architecture",children:"ROS 2 Graph Architecture"}),"\n",(0,r.jsxs)(n.p,{children:["A ROS 2 system is a ",(0,r.jsx)(n.strong,{children:"computation graph"})," where:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Nodes"})," are vertices (processes doing work)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Topics, Services, Actions"})," are edges (communication channels)"]}),"\n"]}),"\n",(0,r.jsx)(n.mermaid,{value:"graph LR\n    A[Camera Node] --\x3e|/image_raw<br/>sensor_msgs/Image| B[Object Detector]\n    B --\x3e|/detections<br/>vision_msgs/Detection2DArray| C[Task Planner]\n    C --\x3e|/arm_goal<br/>Action| D[Arm Controller]\n    C --\x3e|/nav_goal<br/>Action| E[Base Controller]\n    D --\x3e|/joint_commands<br/>trajectory_msgs/JointTrajectory| F[Humanoid Robot]\n    E --\x3e|/cmd_vel<br/>geometry_msgs/Twist| F"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Key characteristics"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Decoupled"}),": Nodes don't need to know about each other's implementation"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Scalable"}),": Add new nodes without modifying existing ones"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Distributed"}),": Nodes can run on different machines (robot, workstation, cloud)"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"node-lifecycle",children:"Node Lifecycle"}),"\n",(0,r.jsx)(n.p,{children:"ROS 2 nodes have a lifecycle with states and transitions:"}),"\n",(0,r.jsx)(n.mermaid,{value:"stateDiagram-v2\n    [*] --\x3e Unconfigured: create\n    Unconfigured --\x3e Inactive: configure\n    Inactive --\x3e Active: activate\n    Active --\x3e Inactive: deactivate\n    Inactive --\x3e Unconfigured: cleanup\n    Unconfigured --\x3e [*]: destroy\n    Active --\x3e Active: spin"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"States explained"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Unconfigured"}),": Node created but not initialized"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Inactive"}),": Configured (parameters loaded, connections established) but not processing"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Active"}),": Fully operational, processing callbacks"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Finalized"}),": Shutdown, resources released"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"For simple nodes (like in this chapter), we'll use the simplified lifecycle where nodes go directly to Active upon creation."}),"\n",(0,r.jsx)(n.h2,{id:"hands-on-tutorial-minimal-node",children:"Hands-On Tutorial: Minimal Node"}),"\n",(0,r.jsx)(n.p,{children:'Let\'s start with the simplest possible ROS 2 node\u2014one that just prints "Hello ROS 2!" every second.'}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",metastring:'showLineNumbers title="minimal_node.py"',children:'# File: minimal_node.py\nimport rclpy\nfrom rclpy.node import Node\n\nclass MinimalNode(Node):\n    """\n    A minimal ROS 2 node that prints a message every second.\n    Demonstrates basic node structure and timer usage.\n    """\n    def __init__(self):\n        # Initialize the node with name \'minimal_node\'\n        super().__init__(\'minimal_node\')\n\n        # Create a timer that calls timer_callback every 1.0 seconds\n        self.timer = self.create_timer(1.0, self.timer_callback)\n        self.count = 0\n\n        self.get_logger().info(\'Minimal node started!\')\n\n    def timer_callback(self):\n        """Called every second by the timer"""\n        self.count += 1\n        self.get_logger().info(f\'Hello ROS 2! Count: {self.count}\')\n\ndef main(args=None):\n    # Initialize the ROS 2 Python client library\n    rclpy.init(args=args)\n\n    # Create the node\n    node = MinimalNode()\n\n    # Spin the node (process callbacks until shutdown)\n    rclpy.spin(node)\n\n    # Cleanup\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == \'__main__\':\n    main()\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"How to run"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Make the file executable\nchmod +x minimal_node.py\n\n# Run the node\npython3 minimal_node.py\n\n# Output:\n# [INFO] [minimal_node]: Minimal node started!\n# [INFO] [minimal_node]: Hello ROS 2! Count: 1\n# [INFO] [minimal_node]: Hello ROS 2! Count: 2\n# ...\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Key components"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Line 1-2"}),": Import rclpy (ROS 2 Python client library) and Node base class"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Line 12"}),": Call parent constructor with node name"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Line 15"}),": Create timer (1 Hz) that triggers callback"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Line 27"}),": Initialize rclpy (must be called before creating nodes)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Line 33"}),": ",(0,r.jsx)(n.code,{children:"spin()"})," keeps node alive, processing callbacks until Ctrl+C"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"hands-on-tutorial-talkerlistener-pair",children:"Hands-On Tutorial: Talker/Listener Pair"}),"\n",(0,r.jsxs)(n.p,{children:["Now let's implement the classic ROS 2 example: a ",(0,r.jsx)(n.strong,{children:"publisher"})," (talker) sends messages, a ",(0,r.jsx)(n.strong,{children:"subscriber"})," (listener) receives them."]}),"\n",(0,r.jsx)(n.h3,{id:"publisher-talker",children:"Publisher (Talker)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",metastring:'showLineNumbers title="talker.py"',children:"# File: talker.py\nimport rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass TalkerNode(Node):\n    \"\"\"\n    Publisher node that sends string messages on /chatter topic.\n    \"\"\"\n    def __init__(self):\n        super().__init__('talker')\n\n        # Create publisher: topic '/chatter', message type String, queue size 10\n        self.publisher_ = self.create_publisher(String, '/chatter', 10)\n\n        # Timer to publish at 2 Hz\n        self.timer = self.create_timer(0.5, self.publish_message)\n        self.count = 0\n\n        self.get_logger().info('Talker node started, publishing to /chatter')\n\n    def publish_message(self):\n        \"\"\"Publish a message every 0.5 seconds\"\"\"\n        msg = String()\n        msg.data = f'Hello from Talker! Message #{self.count}'\n\n        # Publish the message\n        self.publisher_.publish(msg)\n        self.get_logger().info(f'Published: \"{msg.data}\"')\n\n        self.count += 1\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = TalkerNode()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsx)(n.h3,{id:"subscriber-listener",children:"Subscriber (Listener)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",metastring:'showLineNumbers title="listener.py"',children:'# File: listener.py\nimport rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass ListenerNode(Node):\n    """\n    Subscriber node that receives string messages from /chatter topic.\n    """\n    def __init__(self):\n        super().__init__(\'listener\')\n\n        # Create subscriber: topic \'/chatter\', message type String, callback function\n        self.subscription = self.create_subscription(\n            String,\n            \'/chatter\',\n            self.listener_callback,\n            10  # QoS queue size\n        )\n\n        self.get_logger().info(\'Listener node started, subscribed to /chatter\')\n\n    def listener_callback(self, msg):\n        """Called every time a message is received on /chatter"""\n        self.get_logger().info(f\'Received: "{msg.data}"\')\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = ListenerNode()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == \'__main__\':\n    main()\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"How to run"})," (in two terminals):"]}),"\n",(0,r.jsx)(n.p,{children:"Terminal 1:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'python3 talker.py\n# [INFO] [talker]: Talker node started, publishing to /chatter\n# [INFO] [talker]: Published: "Hello from Talker! Message #0"\n# [INFO] [talker]: Published: "Hello from Talker! Message #1"\n'})}),"\n",(0,r.jsx)(n.p,{children:"Terminal 2:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'python3 listener.py\n# [INFO] [listener]: Listener node started, subscribed to /chatter\n# [INFO] [listener]: Received: "Hello from Talker! Message #0"\n# [INFO] [listener]: Received: "Hello from Talker! Message #1"\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"What's happening"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Talker publishes ",(0,r.jsx)(n.code,{children:"String"})," messages to ",(0,r.jsx)(n.code,{children:"/chatter"})," topic every 0.5 seconds"]}),"\n",(0,r.jsxs)(n.li,{children:["Listener subscribes to ",(0,r.jsx)(n.code,{children:"/chatter"})," and receives messages via callback"]}),"\n",(0,r.jsxs)(n.li,{children:["Communication is ",(0,r.jsx)(n.strong,{children:"one-to-many"})," (multiple listeners can subscribe to same topic)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Asynchronous"})," (talker doesn't wait for listener acknowledgment)"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"quality-of-service-qos-policies",children:"Quality of Service (QoS) Policies"}),"\n",(0,r.jsxs)(n.p,{children:["Real robotics applications need control over ",(0,r.jsx)(n.strong,{children:"how"})," messages are delivered. QoS policies configure this."]}),"\n",(0,r.jsx)(n.h3,{id:"key-qos-settings",children:"Key QoS Settings"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Policy"}),(0,r.jsx)(n.th,{children:"Options"}),(0,r.jsx)(n.th,{children:"When to Use"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Reliability"})}),(0,r.jsx)(n.td,{children:"Reliable / Best-Effort"}),(0,r.jsx)(n.td,{children:"Reliable: motor commands, Best-Effort: camera streams"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Durability"})}),(0,r.jsx)(n.td,{children:"Transient-Local / Volatile"}),(0,r.jsx)(n.td,{children:"Transient: late-joiners get last message, Volatile: only live data"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"History"})}),(0,r.jsx)(n.td,{children:"Keep-Last-N / Keep-All"}),(0,r.jsx)(n.td,{children:"Keep-Last-1 for latest sensor data, Keep-All for logging"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Liveliness"})}),(0,r.jsx)(n.td,{children:"Automatic / Manual"}),(0,r.jsx)(n.td,{children:"Detect if publisher is still alive"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Deadline"})}),(0,r.jsx)(n.td,{children:"Duration"}),(0,r.jsx)(n.td,{children:"Warn if messages arrive slower than expected"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"example-configuring-qos",children:"Example: Configuring QoS"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",metastring:'showLineNumbers title="qos_publisher.py"',children:"# File: qos_publisher.py\nimport rclpy\nfrom rclpy.node import Node\nfrom rclpy.qos import QoSProfile, QoSReliabilityPolicy, QoSHistoryPolicy\nfrom std_msgs.msg import String\n\nclass QoSPublisher(Node):\n    def __init__(self):\n        super().__init__('qos_publisher')\n\n        # Create custom QoS profile\n        qos_profile = QoSProfile(\n            reliability=QoSReliabilityPolicy.BEST_EFFORT,  # Allow message loss for low latency\n            history=QoSHistoryPolicy.KEEP_LAST,           # Keep only last N messages\n            depth=1                                        # Queue size of 1\n        )\n\n        self.publisher_ = self.create_publisher(String, '/sensor_data', qos_profile)\n        self.timer = self.create_timer(0.1, self.publish_sensor)\n\n    def publish_sensor(self):\n        msg = String()\n        msg.data = f'Sensor reading at {self.get_clock().now().to_msg()}'\n        self.publisher_.publish(msg)\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = QoSPublisher()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsxs)(n.admonition,{title:"QoS Compatibility",type:"warning",children:[(0,r.jsxs)(n.p,{children:["Publishers and subscribers must have ",(0,r.jsx)(n.strong,{children:"compatible"})," QoS settings, or they won't connect!"]}),(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Compatible combinations"}),":"]}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Reliable publisher \u2194 Reliable subscriber \u2705"}),"\n",(0,r.jsx)(n.li,{children:"Best-Effort publisher \u2194 Best-Effort subscriber \u2705"}),"\n",(0,r.jsx)(n.li,{children:"Best-Effort publisher \u2194 Reliable subscriber \u2705"}),"\n",(0,r.jsx)(n.li,{children:"Reliable publisher \u2194 Best-Effort subscriber \u274c (subscriber won't receive messages!)"}),"\n"]}),(0,r.jsxs)(n.p,{children:["Use ",(0,r.jsx)(n.code,{children:"ros2 topic info -v /topic_name"})," to check QoS settings."]})]}),"\n",(0,r.jsx)(n.h2,{id:"topics-vs-services-vs-actions-when-to-use-what",children:"Topics vs Services vs Actions: When to Use What?"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Communication Pattern"}),(0,r.jsx)(n.th,{children:"Use Case"}),(0,r.jsx)(n.th,{children:"Example"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Topic"})}),(0,r.jsx)(n.td,{children:"Continuous data streams, one-to-many"}),(0,r.jsx)(n.td,{children:"Camera images, sensor readings, robot state"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Service"})}),(0,r.jsx)(n.td,{children:"Request-response, synchronous"}),(0,r.jsx)(n.td,{children:'"Get current joint angles", "Is path collision-free?"'})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Action"})}),(0,r.jsx)(n.td,{children:"Long-running tasks with feedback"}),(0,r.jsx)(n.td,{children:'"Walk to goal", "Grasp object", "Navigate to waypoint"'})]})]})]}),"\n",(0,r.jsx)(n.p,{children:"Decision tree:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Need communication?\n\u251c\u2500 Continuous stream? \u2192 Topic\n\u251c\u2500 Quick request/response (< 1 sec)? \u2192 Service\n\u2514\u2500 Long task with progress updates? \u2192 Action\n"})}),"\n",(0,r.jsx)(n.h2,{id:"hands-on-tutorial-service-serverclient",children:"Hands-On Tutorial: Service Server/Client"}),"\n",(0,r.jsxs)(n.p,{children:["Services implement ",(0,r.jsx)(n.strong,{children:"request-response"})," patterns. Let's build a service that adds two integers."]}),"\n",(0,r.jsx)(n.h3,{id:"service-server",children:"Service Server"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",metastring:'showLineNumbers title="add_server.py"',children:"# File: add_server.py\nimport rclpy\nfrom rclpy.node import Node\nfrom example_interfaces.srv import AddTwoInts  # Standard service type\n\nclass AddServerNode(Node):\n    \"\"\"\n    Service server that adds two integers.\n    \"\"\"\n    def __init__(self):\n        super().__init__('add_server')\n\n        # Create service: name '/add_two_ints', type AddTwoInts, callback function\n        self.service = self.create_service(\n            AddTwoInts,\n            '/add_two_ints',\n            self.add_callback\n        )\n\n        self.get_logger().info('Add server ready, waiting for requests...')\n\n    def add_callback(self, request, response):\n        \"\"\"\n        Called when a client sends a request.\n        Args:\n            request: Contains request.a and request.b (two integers)\n            response: We fill response.sum\n        \"\"\"\n        response.sum = request.a + request.b\n        self.get_logger().info(f'Request: {request.a} + {request.b} = {response.sum}')\n        return response\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = AddServerNode()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsx)(n.h3,{id:"service-client",children:"Service Client"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",metastring:'showLineNumbers title="add_client.py"',children:"# File: add_client.py\nimport sys\nimport rclpy\nfrom rclpy.node import Node\nfrom example_interfaces.srv import AddTwoInts\n\nclass AddClientNode(Node):\n    \"\"\"\n    Service client that requests addition of two integers.\n    \"\"\"\n    def __init__(self):\n        super().__init__('add_client')\n\n        # Create client: service name '/add_two_ints', type AddTwoInts\n        self.client = self.create_client(AddTwoInts, '/add_two_ints')\n\n        # Wait for service to be available (timeout 5 seconds)\n        while not self.client.wait_for_service(timeout_sec=5.0):\n            self.get_logger().warn('Service /add_two_ints not available, waiting...')\n\n        self.get_logger().info('Connected to service /add_two_ints')\n\n    def send_request(self, a, b):\n        \"\"\"Send request to add two integers\"\"\"\n        request = AddTwoInts.Request()\n        request.a = a\n        request.b = b\n\n        # Call service (async, returns future)\n        future = self.client.call_async(request)\n        return future\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    # Get numbers from command line\n    if len(sys.argv) != 3:\n        print('Usage: python3 add_client.py <a> <b>')\n        return\n\n    a = int(sys.argv[1])\n    b = int(sys.argv[2])\n\n    node = AddClientNode()\n    future = node.send_request(a, b)\n\n    # Wait for response (spin until future is complete)\n    rclpy.spin_until_future_complete(node, future)\n\n    if future.result() is not None:\n        response = future.result()\n        node.get_logger().info(f'Result: {a} + {b} = {response.sum}')\n    else:\n        node.get_logger().error('Service call failed!')\n\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"How to run"}),":"]}),"\n",(0,r.jsx)(n.p,{children:"Terminal 1 (server):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"python3 add_server.py\n# [INFO] [add_server]: Add server ready, waiting for requests...\n"})}),"\n",(0,r.jsx)(n.p,{children:"Terminal 2 (client):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"python3 add_client.py 5 7\n# [INFO] [add_client]: Connected to service /add_two_ints\n# [INFO] [add_client]: Result: 5 + 7 = 12\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Key points"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Synchronous"})," (client waits for response)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"One-to-one"})," (only one server per service name)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Stateless"})," (each request is independent)"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"hands-on-tutorial-action-serverclient",children:"Hands-On Tutorial: Action Server/Client"}),"\n",(0,r.jsxs)(n.p,{children:["Actions are for ",(0,r.jsx)(n.strong,{children:"long-running tasks"})," that provide ",(0,r.jsx)(n.strong,{children:"feedback"})," and can be ",(0,r.jsx)(n.strong,{children:"canceled"}),'. Perfect for humanoid tasks like "walk to goal" or "grasp object".']}),"\n",(0,r.jsx)(n.h3,{id:"action-server",children:"Action Server"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",metastring:'showLineNumbers title="fibonacci_action_server.py"',children:"# File: fibonacci_action_server.py\nimport time\nimport rclpy\nfrom rclpy.action import ActionServer\nfrom rclpy.node import Node\nfrom example_interfaces.action import Fibonacci  # Standard action type\n\nclass FibonacciActionServer(Node):\n    \"\"\"\n    Action server that computes Fibonacci sequence.\n    Demonstrates goal execution, feedback, and result.\n    \"\"\"\n    def __init__(self):\n        super().__init__('fibonacci_action_server')\n\n        # Create action server\n        self._action_server = ActionServer(\n            self,\n            Fibonacci,\n            '/fibonacci',\n            self.execute_callback\n        )\n\n        self.get_logger().info('Fibonacci action server started')\n\n    def execute_callback(self, goal_handle):\n        \"\"\"\n        Execute the Fibonacci goal.\n        Args:\n            goal_handle: Contains goal.order (number of Fibonacci numbers to compute)\n        \"\"\"\n        self.get_logger().info(f'Executing goal: compute {goal_handle.request.order} Fibonacci numbers')\n\n        # Initialize feedback and result\n        feedback_msg = Fibonacci.Feedback()\n        feedback_msg.sequence = [0, 1]\n\n        # Compute Fibonacci sequence\n        for i in range(1, goal_handle.request.order):\n            # Check if goal was canceled\n            if goal_handle.is_cancel_requested:\n                goal_handle.canceled()\n                self.get_logger().info('Goal canceled')\n                return Fibonacci.Result()\n\n            # Compute next Fibonacci number\n            feedback_msg.sequence.append(\n                feedback_msg.sequence[i] + feedback_msg.sequence[i-1]\n            )\n\n            # Publish feedback\n            self.get_logger().info(f'Feedback: {feedback_msg.sequence}')\n            goal_handle.publish_feedback(feedback_msg)\n\n            # Simulate computation time\n            time.sleep(0.5)\n\n        # Goal succeeded\n        goal_handle.succeed()\n\n        # Return result\n        result = Fibonacci.Result()\n        result.sequence = feedback_msg.sequence\n        self.get_logger().info(f'Goal succeeded! Result: {result.sequence}')\n        return result\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = FibonacciActionServer()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsx)(n.h3,{id:"action-client",children:"Action Client"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",metastring:'showLineNumbers title="fibonacci_action_client.py"',children:'# File: fibonacci_action_client.py\nimport rclpy\nfrom rclpy.action import ActionClient\nfrom rclpy.node import Node\nfrom example_interfaces.action import Fibonacci\n\nclass FibonacciActionClient(Node):\n    """\n    Action client that requests Fibonacci sequence computation.\n    """\n    def __init__(self):\n        super().__init__(\'fibonacci_action_client\')\n\n        # Create action client\n        self._action_client = ActionClient(self, Fibonacci, \'/fibonacci\')\n\n        self.get_logger().info(\'Waiting for action server...\')\n        self._action_client.wait_for_server()\n        self.get_logger().info(\'Action server available!\')\n\n    def send_goal(self, order):\n        """Send goal to compute Fibonacci sequence"""\n        goal_msg = Fibonacci.Goal()\n        goal_msg.order = order\n\n        self.get_logger().info(f\'Sending goal: compute {order} Fibonacci numbers\')\n\n        # Send goal with callbacks\n        self._send_goal_future = self._action_client.send_goal_async(\n            goal_msg,\n            feedback_callback=self.feedback_callback\n        )\n\n        self._send_goal_future.add_done_callback(self.goal_response_callback)\n\n    def goal_response_callback(self, future):\n        """Called when server accepts/rejects goal"""\n        goal_handle = future.result()\n\n        if not goal_handle.accepted:\n            self.get_logger().error(\'Goal rejected!\')\n            return\n\n        self.get_logger().info(\'Goal accepted, waiting for result...\')\n\n        # Get result\n        self._get_result_future = goal_handle.get_result_async()\n        self._get_result_future.add_done_callback(self.get_result_callback)\n\n    def get_result_callback(self, future):\n        """Called when result is ready"""\n        result = future.result().result\n        self.get_logger().info(f\'Result received: {result.sequence}\')\n        rclpy.shutdown()\n\n    def feedback_callback(self, feedback_msg):\n        """Called when server publishes feedback"""\n        feedback = feedback_msg.feedback\n        self.get_logger().info(f\'Feedback: {feedback.sequence}\')\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = FibonacciActionClient()\n    node.send_goal(10)  # Request 10 Fibonacci numbers\n    rclpy.spin(node)\n    node.destroy_node()\n\nif __name__ == \'__main__\':\n    main()\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"How to run"}),":"]}),"\n",(0,r.jsx)(n.p,{children:"Terminal 1 (server):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"python3 fibonacci_action_server.py\n# [INFO] [fibonacci_action_server]: Fibonacci action server started\n# [INFO] [fibonacci_action_server]: Executing goal: compute 10 Fibonacci numbers\n# [INFO] [fibonacci_action_server]: Feedback: [0, 1, 1]\n# [INFO] [fibonacci_action_server]: Feedback: [0, 1, 1, 2]\n# ...\n# [INFO] [fibonacci_action_server]: Goal succeeded! Result: [0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55]\n"})}),"\n",(0,r.jsx)(n.p,{children:"Terminal 2 (client):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"python3 fibonacci_action_client.py\n# [INFO] [fibonacci_action_client]: Action server available!\n# [INFO] [fibonacci_action_client]: Sending goal: compute 10 Fibonacci numbers\n# [INFO] [fibonacci_action_client]: Goal accepted, waiting for result...\n# [INFO] [fibonacci_action_client]: Feedback: [0, 1, 1]\n# ...\n# [INFO] [fibonacci_action_client]: Result received: [0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55]\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Why use actions?"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Feedback"}),': Client sees progress (critical for "walk 10 meters" - you want to know current distance!)']}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Cancellation"}),': Client can stop action mid-execution ("stop walking, obstacle detected!")']}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Asynchronous"}),": Client continues other work while action executes"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"common-message-types",children:"Common Message Types"}),"\n",(0,r.jsxs)(n.p,{children:["ROS 2 provides standard message types in packages like ",(0,r.jsx)(n.code,{children:"std_msgs"}),", ",(0,r.jsx)(n.code,{children:"sensor_msgs"}),", ",(0,r.jsx)(n.code,{children:"geometry_msgs"}),". Using standard types ensures interoperability."]}),"\n",(0,r.jsx)(n.h3,{id:"key-message-packages-for-humanoids",children:"Key Message Packages for Humanoids"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Package"}),(0,r.jsx)(n.th,{children:"Common Types"}),(0,r.jsx)(n.th,{children:"Use Case"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"std_msgs"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"String"}),", ",(0,r.jsx)(n.code,{children:"Int32"}),", ",(0,r.jsx)(n.code,{children:"Float64"}),", ",(0,r.jsx)(n.code,{children:"Bool"})]}),(0,r.jsx)(n.td,{children:"Simple data"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"geometry_msgs"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"Twist"}),", ",(0,r.jsx)(n.code,{children:"Pose"}),", ",(0,r.jsx)(n.code,{children:"PoseStamped"}),", ",(0,r.jsx)(n.code,{children:"Transform"})]}),(0,r.jsx)(n.td,{children:"Robot motion, position"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"sensor_msgs"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"Image"}),", ",(0,r.jsx)(n.code,{children:"CameraInfo"}),", ",(0,r.jsx)(n.code,{children:"Imu"}),", ",(0,r.jsx)(n.code,{children:"JointState"}),", ",(0,r.jsx)(n.code,{children:"LaserScan"})]}),(0,r.jsx)(n.td,{children:"Sensor data"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"trajectory_msgs"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"JointTrajectory"}),", ",(0,r.jsx)(n.code,{children:"MultiDOFJointTrajectory"})]}),(0,r.jsx)(n.td,{children:"Joint motion"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"nav_msgs"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"Odometry"}),", ",(0,r.jsx)(n.code,{children:"Path"})]}),(0,r.jsx)(n.td,{children:"Navigation"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example: Velocity command for humanoid base"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from geometry_msgs.msg import Twist\n\n# Create velocity command\ncmd_vel = Twist()\ncmd_vel.linear.x = 0.5   # Move forward at 0.5 m/s\ncmd_vel.linear.y = 0.0   # No lateral movement\ncmd_vel.angular.z = 0.1  # Turn left at 0.1 rad/s\n\npublisher.publish(cmd_vel)\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example: Joint state for humanoid arms"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from sensor_msgs.msg import JointState\n\njoint_state = JointState()\njoint_state.name = ['shoulder_pan', 'shoulder_lift', 'elbow', 'wrist']\njoint_state.position = [0.0, -1.57, 1.57, 0.0]  # radians\njoint_state.velocity = [0.0, 0.0, 0.0, 0.0]\njoint_state.effort = [0.0, 0.0, 0.0, 0.0]  # torques\n\npublisher.publish(joint_state)\n"})}),"\n",(0,r.jsx)(n.h2,{id:"communication-patterns-comparison",children:"Communication Patterns Comparison"}),"\n",(0,r.jsx)(n.mermaid,{value:"graph TD\n    subgraph Topics\n        A1[Publisher] --\x3e|One-to-Many<br/>Async| A2[Subscriber 1]\n        A1 --\x3e|One-to-Many<br/>Async| A3[Subscriber 2]\n    end\n\n    subgraph Services\n        B1[Client] --\x3e|Request<br/>Sync| B2[Server]\n        B2 --\x3e|Response<br/>Sync| B1\n    end\n\n    subgraph Actions\n        C1[Client] --\x3e|Goal<br/>Async| C2[Server]\n        C2 --\x3e|Feedback<br/>Async| C1\n        C2 --\x3e|Result<br/>Async| C1\n        C1 -.->|Cancel| C2\n    end"}),"\n",(0,r.jsx)(n.h2,{id:"end-of-chapter-exercises",children:"End-of-Chapter Exercises"}),"\n",(0,r.jsx)(n.h3,{id:"exercise-1-temperature-monitor-easy",children:"Exercise 1: Temperature Monitor (Easy)"}),"\n",(0,r.jsx)(n.p,{children:"Create a publisher that simulates a temperature sensor:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Publish to ",(0,r.jsx)(n.code,{children:"/temperature"})," topic"]}),"\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.code,{children:"std_msgs/Float64"})," message type"]}),"\n",(0,r.jsx)(n.li,{children:"Publish random temperature between 20-30\xb0C every second"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Acceptance"}),": Node publishes messages visible with ",(0,r.jsx)(n.code,{children:"ros2 topic echo /temperature"})]}),"\n",(0,r.jsx)(n.h3,{id:"exercise-2-emergency-stop-subscriber-easy",children:"Exercise 2: Emergency Stop Subscriber (Easy)"}),"\n",(0,r.jsxs)(n.p,{children:["Create a subscriber that listens to ",(0,r.jsx)(n.code,{children:"/emergency_stop"})," topic (",(0,r.jsx)(n.code,{children:"std_msgs/Bool"}),"):"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["When ",(0,r.jsx)(n.code,{children:"True"}),' received, log "EMERGENCY STOP ACTIVATED!"']}),"\n",(0,r.jsxs)(n.li,{children:["When ",(0,r.jsx)(n.code,{children:"False"}),' received, log "System resumed"']}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Acceptance"}),": Node responds to messages published with ",(0,r.jsx)(n.code,{children:"ros2 topic pub"})]}),"\n",(0,r.jsx)(n.h3,{id:"exercise-3-string-reversal-service-medium",children:"Exercise 3: String Reversal Service (Medium)"}),"\n",(0,r.jsx)(n.p,{children:"Create a service that reverses strings:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Service name: ",(0,r.jsx)(n.code,{children:"/reverse_string"})]}),"\n",(0,r.jsxs)(n.li,{children:["Use a custom request/response (or ",(0,r.jsx)(n.code,{children:"example_interfaces/srv/Trigger"})," with string in response)"]}),"\n",(0,r.jsx)(n.li,{children:"Server reverses input string and returns result"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Acceptance"}),': Client sends "hello" and receives "olleh"']}),"\n",(0,r.jsx)(n.h3,{id:"exercise-4-countdown-action-medium",children:"Exercise 4: Countdown Action (Medium)"}),"\n",(0,r.jsx)(n.p,{children:"Create an action server that counts down from N to 0:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Action name: ",(0,r.jsx)(n.code,{children:"/countdown"})]}),"\n",(0,r.jsx)(n.li,{children:"Goal: integer N"}),"\n",(0,r.jsx)(n.li,{children:"Feedback: current count every second"}),"\n",(0,r.jsx)(n.li,{children:'Result: "Countdown complete!"'}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Acceptance"}),": Client sees feedback printed as countdown progresses"]}),"\n",(0,r.jsx)(n.h3,{id:"exercise-5-multi-node-humanoid-system-hard",children:"Exercise 5: Multi-Node Humanoid System (Hard)"}),"\n",(0,r.jsx)(n.p,{children:"Design a 3-node system for a humanoid:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Vision Node"}),": Publishes ",(0,r.jsx)(n.code,{children:"/detected_objects"})," (simulate with timer + random data)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Planner Node"}),": Subscribes to ",(0,r.jsx)(n.code,{children:"/detected_objects"}),", publishes ",(0,r.jsx)(n.code,{children:"/target_pose"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Controller Node"}),": Subscribes to ",(0,r.jsx)(n.code,{children:"/target_pose"}),', logs "Moving to target: [x, y, z]"']}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Acceptance"}),": All three nodes communicate correctly when run simultaneously"]}),"\n",(0,r.jsx)(n.h3,{id:"exercise-6-qos-experiment-medium",children:"Exercise 6: QoS Experiment (Medium)"}),"\n",(0,r.jsx)(n.p,{children:"Create two pairs of talker/listener nodes:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Pair 1"}),": Both use Reliable QoS"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Pair 2"}),": Publisher uses Reliable, Subscriber uses Best-Effort"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Run both pairs and observe which pair communicates successfully. Explain why."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Acceptance"}),": Correct prediction (Pair 1 works, Pair 2 doesn't) with QoS compatibility explanation"]}),"\n",(0,r.jsx)(n.h2,{id:"capstone-integration",children:"Capstone Integration"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"How This Chapter Connects to the Final Humanoid Project"})}),"\n",(0,r.jsx)(n.p,{children:"Your capstone humanoid will have a multi-node architecture:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Perception nodes"})," (publishers): Camera streams \u2192 ",(0,r.jsx)(n.code,{children:"/camera/image_raw"}),", Object detection \u2192 ",(0,r.jsx)(n.code,{children:"/detected_objects"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Planning nodes"})," (subscribers + publishers): Subscribe to perception, publish ",(0,r.jsx)(n.code,{children:"/navigation/goal"}),", ",(0,r.jsx)(n.code,{children:"/manipulation/target"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Control nodes"})," (action servers): Execute ",(0,r.jsx)(n.code,{children:"/walk_to_goal"})," action, ",(0,r.jsx)(n.code,{children:"/grasp_object"})," action with feedback"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Low-level controllers"})," (subscribers): Listen to ",(0,r.jsx)(n.code,{children:"/joint_commands"}),", send to motors"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"From this chapter, you now know"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"How to structure nodes for each subsystem"}),"\n",(0,r.jsx)(n.li,{children:"When to use topics (sensor streams), services (queries), actions (tasks)"}),"\n",(0,r.jsx)(n.li,{children:"How to configure QoS (reliable for commands, best-effort for camera streams)"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsx)(n.p,{children:"In this chapter, you learned:"}),"\n",(0,r.jsxs)(n.p,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Nodes"}),": Independent processes that perform computation and communicate via ROS 2 graph\n\u2705 ",(0,r.jsx)(n.strong,{children:"Topics"}),": Publish-subscribe communication for one-to-many, continuous data streams\n\u2705 ",(0,r.jsx)(n.strong,{children:"Services"}),": Request-response communication for synchronous queries\n\u2705 ",(0,r.jsx)(n.strong,{children:"Actions"}),": Goal-oriented communication with feedback and cancellation for long-running tasks\n\u2705 ",(0,r.jsx)(n.strong,{children:"QoS Policies"}),": Configure reliability, durability, history for application-specific needs\n\u2705 ",(0,r.jsx)(n.strong,{children:"Message Types"}),": Standard messages (",(0,r.jsx)(n.code,{children:"sensor_msgs"}),", ",(0,r.jsx)(n.code,{children:"geometry_msgs"}),") for interoperability"]}),"\n",(0,r.jsx)(n.h2,{id:"whats-next",children:"What's Next?"}),"\n",(0,r.jsx)(n.p,{children:"You can now write ROS 2 nodes that communicate! But as your robot grows, you'll have 10+ nodes. How do you organize them?"}),"\n",(0,r.jsxs)(n.p,{children:["In ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"/ai_native-textbook/docs/module-1/chapter-3-ros2-packages-launch",children:"Chapter 3: Packages, Launch Files, and Parameters \u2192"})}),", you'll learn:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"How to structure ROS 2 code into packages"}),"\n",(0,r.jsx)(n.li,{children:"Use launch files to start multiple nodes with one command"}),"\n",(0,r.jsx)(n.li,{children:"Manage configuration through parameters"}),"\n",(0,r.jsx)(n.li,{children:"Integrate with Gazebo and Isaac Sim"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Additional Resources"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://docs.ros2.org/latest/api/rclpy/",children:"rclpy API Documentation"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://docs.ros.org/en/humble/Concepts/About-Different-Middleware-Vendors.html",children:"ROS 2 Communication Patterns"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://docs.ros.org/en/humble/Concepts/About-Quality-of-Service-Settings.html",children:"QoS Guide"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/ros2/common_interfaces",children:"Standard Message Types"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>o});var i=s(6540);const r={},t=i.createContext(r);function l(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);