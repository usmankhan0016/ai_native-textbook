"use strict";(self.webpackChunkphysical_ai_humanoid_robotics_textbook=self.webpackChunkphysical_ai_humanoid_robotics_textbook||[]).push([[2622],{8453:(n,e,i)=>{i.d(e,{R:()=>a,x:()=>o});var t=i(6540);const s={},r=t.createContext(s);function a(n){const e=t.useContext(r);return t.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:a(n.components),t.createElement(r.Provider,{value:e},n.children)}},8907:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"module-2/chapter-4-unity-high-fidelity-simulation","title":"Chapter 4: High-Fidelity Simulation in Unity","description":"Estimated time Advanced | Week: 7, Days 4-5","source":"@site/docs/module-2/chapter-4-unity-high-fidelity-simulation.md","sourceDirName":"module-2","slug":"/module-2/chapter-4-unity-high-fidelity-simulation","permalink":"/ai_native-textbook/docs/module-2/chapter-4-unity-high-fidelity-simulation","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"unity","permalink":"/ai_native-textbook/docs/tags/unity"},{"inline":true,"label":"rendering","permalink":"/ai_native-textbook/docs/tags/rendering"},{"inline":true,"label":"photorealistic","permalink":"/ai_native-textbook/docs/tags/photorealistic"},{"inline":true,"label":"simulation","permalink":"/ai_native-textbook/docs/tags/simulation"},{"inline":true,"label":"week-7","permalink":"/ai_native-textbook/docs/tags/week-7"}],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"sidebar_label":"Ch.4: Unity High-Fidelity","title":"Chapter 4: High-Fidelity Simulation in Unity","tags":["unity","rendering","photorealistic","simulation","week-7"],"difficulty":"Advanced","module":2,"week":7,"prerequisites":["Chapters 1-3","Unity 2022 LTS"],"estimated_time":"4-5 hours","topics":["unity-robotics","ros2-communication","rendering-pipelines","dataset-export","domain-randomization"]},"sidebar":"tutorialSidebar","previous":{"title":"Ch.3: Sensor Simulation","permalink":"/ai_native-textbook/docs/module-2/chapter-3-sensor-simulation"},"next":{"title":"Week 6: Gazebo Fundamentals","permalink":"/ai_native-textbook/docs/module-2/week-6"}}');var s=i(4848),r=i(8453);const a={sidebar_position:4,sidebar_label:"Ch.4: Unity High-Fidelity",title:"Chapter 4: High-Fidelity Simulation in Unity",tags:["unity","rendering","photorealistic","simulation","week-7"],difficulty:"Advanced",module:2,week:7,prerequisites:["Chapters 1-3","Unity 2022 LTS"],estimated_time:"4-5 hours",topics:["unity-robotics","ros2-communication","rendering-pipelines","dataset-export","domain-randomization"]},o="Chapter 4: High-Fidelity Simulation in Unity",l={},d=[{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"Key Concepts",id:"key-concepts",level:2},{value:"Why Unity for Robotics?",id:"why-unity-for-robotics",level:2},{value:"Advantages",id:"advantages",level:3},{value:"Disadvantages",id:"disadvantages",level:3},{value:"Recommended Use",id:"recommended-use",level:3},{value:"PhysX vs. Gazebo Physics Engines",id:"physx-vs-gazebo-physics-engines",level:2},{value:"Comparison Table",id:"comparison-table",level:3},{value:"When to Use Each",id:"when-to-use-each",level:3},{value:"Setting Up Unity for Robotics",id:"setting-up-unity-for-robotics",level:2},{value:"Step 1: Install Unity 2022 LTS",id:"step-1-install-unity-2022-lts",level:3},{value:"Step 2: Install ros2cs Plugin",id:"step-2-install-ros2cs-plugin",level:3},{value:"Step 3: Configure Project Settings",id:"step-3-configure-project-settings",level:3},{value:"ROS 2 \u2194 Unity Communication via ros2cs",id:"ros-2--unity-communication-via-ros2cs",level:2},{value:"Publishing to ROS 2 (Send Joint States)",id:"publishing-to-ros-2-send-joint-states",level:3},{value:"Subscribing from ROS 2 (Receive Commands)",id:"subscribing-from-ros-2-receive-commands",level:3},{value:"Importing Humanoid Models",id:"importing-humanoid-models",level:2},{value:"From URDF to Unity",id:"from-urdf-to-unity",level:3},{value:"Configure Materials and Lighting",id:"configure-materials-and-lighting",level:3},{value:"Grasping and Manipulation",id:"grasping-and-manipulation",level:2},{value:"D6 Joint Constraint (Grasping)",id:"d6-joint-constraint-grasping",level:3},{value:"High-Fidelity Rendering",id:"high-fidelity-rendering",level:2},{value:"HDRP Pipeline Setup",id:"hdrp-pipeline-setup",level:3},{value:"HDRP Material Configuration",id:"hdrp-material-configuration",level:3},{value:"Lighting for Photorealism",id:"lighting-for-photorealism",level:3},{value:"Exporting Training Datasets",id:"exporting-training-datasets",level:2},{value:"Ground Truth Annotation Format",id:"ground-truth-annotation-format",level:3},{value:"Dataset Exporter Script",id:"dataset-exporter-script",level:3},{value:"Domain Randomization",id:"domain-randomization",level:2},{value:"Hands-On Labs",id:"hands-on-labs",level:2},{value:"Lab 1: Set Up Unity ROS 2 Bridge",id:"lab-1-set-up-unity-ros-2-bridge",level:3},{value:"Lab 2: Import Humanoid and Test Grasping",id:"lab-2-import-humanoid-and-test-grasping",level:3},{value:"Lab 3: Photorealistic Rendering and Dataset Export",id:"lab-3-photorealistic-rendering-and-dataset-export",level:3},{value:"End-of-Chapter Exercises",id:"end-of-chapter-exercises",level:2},{value:"Exercise 1: ROS 2 Communication Pipeline",id:"exercise-1-ros-2-communication-pipeline",level:3},{value:"Exercise 2: Grasping Evaluation",id:"exercise-2-grasping-evaluation",level:3},{value:"Exercise 3: Rendering Quality Comparison",id:"exercise-3-rendering-quality-comparison",level:3},{value:"Exercise 4: Dataset Generation and Validation",id:"exercise-4-dataset-generation-and-validation",level:3},{value:"Summary",id:"summary",level:2},{value:"Capstone Preparation",id:"capstone-preparation",level:2}];function c(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.header,{children:(0,s.jsx)(e.h1,{id:"chapter-4-high-fidelity-simulation-in-unity",children:"Chapter 4: High-Fidelity Simulation in Unity"})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Estimated time"}),": 4-5 hours | ",(0,s.jsx)(e.strong,{children:"Difficulty"}),": Advanced | ",(0,s.jsx)(e.strong,{children:"Week"}),": 7, Days 4-5"]}),"\n",(0,s.jsx)(e.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,s.jsx)(e.p,{children:"After completing this chapter, you will be able to:"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Explain why Unity is valuable"})," for high-fidelity robotics visualization and training data generation"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Compare PhysX with Gazebo physics engines"})," and understand their respective strengths"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Set up a Unity robotics project"})," with required packages and ROS 2 bridge"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Establish ROS 2 \u2194 Unity communication"})," using the ros2cs library"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Import humanoid models"})," into Unity with correct materials and physics"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Simulate grasping and object interaction"})," using D6 joint constraints"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Configure photorealistic rendering"})," using HDRP (High-Definition Render Pipeline)"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Export synthetic training datasets"})," with ground truth annotations"]}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"key-concepts",children:"Key Concepts"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"PhysX"}),": NVIDIA's physics engine used by Unity (different from Gazebo's ODE/Bullet/DART)"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"ros2cs"}),": C# bindings that allow Unity scripts to communicate with ROS 2"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"HDRP vs URP"}),": High-Definition (photorealistic, GPU-intensive) vs Universal (mobile, fast) rendering pipelines"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Domain randomization"}),": Vary lighting, materials, camera pose to create robust training datasets"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Ground truth"}),": Perfect annotations (pose, depth, segmentation) generated in simulation"]}),"\n"]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"why-unity-for-robotics",children:"Why Unity for Robotics?"}),"\n",(0,s.jsx)(e.h3,{id:"advantages",children:"Advantages"}),"\n",(0,s.jsxs)(e.p,{children:["\u2705 ",(0,s.jsx)(e.strong,{children:"High-fidelity rendering"}),": Photorealistic visuals with HDRP pipeline\n\u2705 ",(0,s.jsx)(e.strong,{children:"Real-time interactivity"}),": Optimized for interactive simulations and demos\n\u2705 ",(0,s.jsx)(e.strong,{children:"Training data"}),": Generate large synthetic datasets with perfect annotations\n\u2705 ",(0,s.jsx)(e.strong,{children:"Visual debugging"}),": Easy to see humanoid movement and interactions\n\u2705 ",(0,s.jsx)(e.strong,{children:"VR/AR integration"}),": Support for virtual/augmented reality environments\n\u2705 ",(0,s.jsx)(e.strong,{children:"Large ecosystem"}),": Thousands of assets, tools, and community resources"]}),"\n",(0,s.jsx)(e.h3,{id:"disadvantages",children:"Disadvantages"}),"\n",(0,s.jsxs)(e.p,{children:["\u274c ",(0,s.jsx)(e.strong,{children:"Physics accuracy"}),": PhysX is optimized for games, not research-grade physics\n\u274c ",(0,s.jsx)(e.strong,{children:"Long-horizon simulations"}),": Not ideal for simulating hours of behavior\n\u274c ",(0,s.jsx)(e.strong,{children:"Batch simulations"}),": Harder to run hundreds of parallel simulations\n\u274c ",(0,s.jsx)(e.strong,{children:"ROS 2 integration"}),": Requires bridge library (ros2cs)"]}),"\n",(0,s.jsx)(e.h3,{id:"recommended-use",children:"Recommended Use"}),"\n",(0,s.jsxs)(e.p,{children:["Use ",(0,s.jsx)(e.strong,{children:"Unity for"}),":"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Visualization of humanoid behavior"}),"\n",(0,s.jsx)(e.li,{children:"Training dataset generation"}),"\n",(0,s.jsx)(e.li,{children:"Real-time interactive control"}),"\n",(0,s.jsx)(e.li,{children:"Stakeholder demos"}),"\n"]}),"\n",(0,s.jsxs)(e.p,{children:["Use ",(0,s.jsx)(e.strong,{children:"Gazebo for"}),":"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Physics validation and algorithm testing"}),"\n",(0,s.jsx)(e.li,{children:"Long-duration simulations"}),"\n",(0,s.jsx)(e.li,{children:"Batch running multiple scenarios"}),"\n",(0,s.jsx)(e.li,{children:"Non-real-time accurate physics"}),"\n"]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"physx-vs-gazebo-physics-engines",children:"PhysX vs. Gazebo Physics Engines"}),"\n",(0,s.jsx)(e.h3,{id:"comparison-table",children:"Comparison Table"}),"\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"Aspect"}),(0,s.jsx)(e.th,{children:"PhysX (Unity)"}),(0,s.jsx)(e.th,{children:"ODE (Gazebo)"}),(0,s.jsx)(e.th,{children:"Bullet (Gazebo)"}),(0,s.jsx)(e.th,{children:"DART (Gazebo)"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"Speed"})}),(0,s.jsx)(e.td,{children:"Fast"}),(0,s.jsx)(e.td,{children:"Medium"}),(0,s.jsx)(e.td,{children:"Faster"}),(0,s.jsx)(e.td,{children:"Slower"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"Accuracy"})}),(0,s.jsx)(e.td,{children:"Medium"}),(0,s.jsx)(e.td,{children:"High"}),(0,s.jsx)(e.td,{children:"Medium"}),(0,s.jsx)(e.td,{children:"Very High"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"Stability"})}),(0,s.jsx)(e.td,{children:"Good"}),(0,s.jsx)(e.td,{children:"Good"}),(0,s.jsx)(e.td,{children:"Variable"}),(0,s.jsx)(e.td,{children:"Excellent"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"Humanoid Dynamics"})}),(0,s.jsx)(e.td,{children:"Moderate"}),(0,s.jsx)(e.td,{children:"Good"}),(0,s.jsx)(e.td,{children:"Moderate"}),(0,s.jsx)(e.td,{children:"Excellent"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"Ease of Use"})}),(0,s.jsx)(e.td,{children:"Easy (visual editor)"}),(0,s.jsx)(e.td,{children:"Moderate (SDF tuning)"}),(0,s.jsx)(e.td,{children:"Easy"}),(0,s.jsx)(e.td,{children:"Hard (many parameters)"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"Best For"})}),(0,s.jsx)(e.td,{children:"Real-time, visualization"}),(0,s.jsx)(e.td,{children:"Research, validation"}),(0,s.jsx)(e.td,{children:"Prototyping"}),(0,s.jsx)(e.td,{children:"Humanoid research"})]})]})]}),"\n",(0,s.jsx)(e.h3,{id:"when-to-use-each",children:"When to Use Each"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"PhysX (Unity)"}),":"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Real-time visualization needed"}),"\n",(0,s.jsx)(e.li,{children:"Interactive control and feedback"}),"\n",(0,s.jsx)(e.li,{children:"Training data with lighting variety"}),"\n",(0,s.jsx)(e.li,{children:"Rapid prototyping"}),"\n"]}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"ODE (Gazebo)"}),":"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Physics algorithm validation"}),"\n",(0,s.jsx)(e.li,{children:"Accurate long-horizon simulation"}),"\n",(0,s.jsx)(e.li,{children:"Publication-quality research"}),"\n",(0,s.jsx)(e.li,{children:"Joint control loops"}),"\n"]}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Bullet (Gazebo)"}),":"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Speed-critical non-real-time sims"}),"\n",(0,s.jsx)(e.li,{children:"Fast iteration during development"}),"\n"]}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"DART (Gazebo)"}),":"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Humanoid-specific dynamics"}),"\n",(0,s.jsx)(e.li,{children:"Contact-rich interactions"}),"\n",(0,s.jsx)(e.li,{children:"Maximum physics fidelity"}),"\n"]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"setting-up-unity-for-robotics",children:"Setting Up Unity for Robotics"}),"\n",(0,s.jsx)(e.h3,{id:"step-1-install-unity-2022-lts",children:"Step 1: Install Unity 2022 LTS"}),"\n",(0,s.jsxs)(e.p,{children:["Download from ",(0,s.jsx)(e.a,{href:"https://unity.com/download",children:"Unity Hub"}),":"]}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsx)(e.li,{children:"Install Unity Hub"}),"\n",(0,s.jsx)(e.li,{children:"Add Unity 2022 LTS version"}),"\n",(0,s.jsx)(e.li,{children:"Create new 3D project"}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"step-2-install-ros2cs-plugin",children:"Step 2: Install ros2cs Plugin"}),"\n",(0,s.jsx)(e.p,{children:"The ros2cs library provides C# bindings for ROS 2:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"# In your Unity project root (outside Assets folder):\ngit clone https://github.com/ROS2ForUnity/ROS2-Unity.git\n# Copy ROS2 folder into Assets/\n"})}),"\n",(0,s.jsx)(e.h3,{id:"step-3-configure-project-settings",children:"Step 3: Configure Project Settings"}),"\n",(0,s.jsx)(e.p,{children:"In Unity Editor:"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.strong,{children:"Window \u2192 TextMesh Pro \u2192 Import TMP Essentials"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.strong,{children:"Edit \u2192 Project Settings \u2192 Player \u2192 Scripting \u2192 .NET Framework 4.7.1 (or later)"})}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Assets \u2192 ROS2 \u2192 ROS2 Settings"}),": Configure ROS 2 domain ID and middleware"]}),"\n"]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"ros-2--unity-communication-via-ros2cs",children:"ROS 2 \u2194 Unity Communication via ros2cs"}),"\n",(0,s.jsx)(e.h3,{id:"publishing-to-ros-2-send-joint-states",children:"Publishing to ROS 2 (Send Joint States)"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-csharp",children:'// File: Assets/Scripts/JointStatePublisher.cs\nusing UnityEngine;\nusing ROS2;\nusing geometry_msgs.msg;\nusing sensor_msgs.msg;\n\npublic class JointStatePublisher : MonoBehaviour\n{\n    private ROS2Node ros2Node;\n    private IPublisher<JointState> jointPub;\n    private Animator humanoidAnimator;\n\n    void Start()\n    {\n        // Initialize ROS 2\n        ros2Node = GetComponent<ROS2Node>();\n        jointPub = ros2Node.CreatePublisher<JointState>("joint_states");\n        humanoidAnimator = GetComponent<Animator>();\n    }\n\n    void Update()\n    {\n        // Publish joint states at 30 Hz\n        var msg = new JointState();\n        msg.Header.Stamp = ROS2.Clock.Now;\n        msg.Name = new string[] { "left_hip_x", "left_hip_y", "left_knee" };\n        msg.Position = new double[]\n        {\n            humanoidAnimator.GetFloat("LeftHipX"),\n            humanoidAnimator.GetFloat("LeftHipY"),\n            humanoidAnimator.GetFloat("LeftKnee")\n        };\n        jointPub.Publish(msg);\n    }\n}\n'})}),"\n",(0,s.jsx)(e.h3,{id:"subscribing-from-ros-2-receive-commands",children:"Subscribing from ROS 2 (Receive Commands)"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-csharp",children:'// File: Assets/Scripts/JointCommandSubscriber.cs\nusing UnityEngine;\nusing ROS2;\nusing sensor_msgs.msg;\n\npublic class JointCommandSubscriber : MonoBehaviour\n{\n    private ROS2Node ros2Node;\n    private ISubscription<JointState> cmdSub;\n    private Animator humanoidAnimator;\n\n    void Start()\n    {\n        ros2Node = GetComponent<ROS2Node>();\n        cmdSub = ros2Node.CreateSubscription<JointState>(\n            "cmd_joints",\n            JointCommandCallback\n        );\n        humanoidAnimator = GetComponent<Animator>();\n    }\n\n    void JointCommandCallback(JointState msg)\n    {\n        // Update animator parameters from ROS 2 command\n        for (int i = 0; i < msg.Name.Length; i++)\n        {\n            humanoidAnimator.SetFloat(msg.Name[i], (float)msg.Position[i]);\n        }\n    }\n}\n'})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"importing-humanoid-models",children:"Importing Humanoid Models"}),"\n",(0,s.jsx)(e.h3,{id:"from-urdf-to-unity",children:"From URDF to Unity"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Export URDF as URDF.zip"})," (includes meshes)"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Use URDF importer"}),":","\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"# In Assets folder:\nAssets/ROS2/URDF Importer \u2192 Import URDF\n"})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Configure PhysX"}),":","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Each body link becomes GameObject with Rigidbody"}),"\n",(0,s.jsx)(e.li,{children:"Colliders auto-added from collision geometry"}),"\n",(0,s.jsx)(e.li,{children:"Joints converted to ConfigurableJoint"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"configure-materials-and-lighting",children:"Configure Materials and Lighting"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-csharp",children:'// File: Assets/Scripts/MaterialConfigurator.cs\nusing UnityEngine;\n\npublic class MaterialConfigurator : MonoBehaviour\n{\n    void Start()\n    {\n        // Find humanoid mesh renderer\n        Renderer meshRenderer = GetComponent<Renderer>();\n\n        // Create PBR material with HDRP shader\n        Material material = new Material(Shader.Find("HDRP/Lit"));\n        material.SetColor("_BaseColor", new Color(0.5f, 0.5f, 0.5f, 1.0f));\n        material.SetFloat("_Metallic", 0.5f);     // 0=non-metal, 1=full metal\n        material.SetFloat("_Smoothness", 0.7f);  // 0=rough, 1=glossy\n\n        meshRenderer.material = material;\n    }\n}\n'})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"grasping-and-manipulation",children:"Grasping and Manipulation"}),"\n",(0,s.jsx)(e.h3,{id:"d6-joint-constraint-grasping",children:"D6 Joint Constraint (Grasping)"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-csharp",children:'// File: Assets/Scripts/GraspController.cs\nusing UnityEngine;\n\npublic class GraspController : MonoBehaviour\n{\n    private ConfigurableJoint graspJoint;\n    private bool isGrasping = false;\n\n    void Start()\n    {\n        // Hand GameObject\n        GameObject hand = transform.Find("right_hand").gameObject;\n\n        // Add D6 joint for grasping\n        graspJoint = hand.AddComponent<ConfigurableJoint>();\n        graspJoint.xMotion = ConfigurableJointMotion.Free;\n        graspJoint.yMotion = ConfigurableJointMotion.Free;\n        graspJoint.zMotion = ConfigurableJointMotion.Free;\n    }\n\n    void OnTriggerEnter(Collider col)\n    {\n        // Grasp object when hand touches it\n        if (col.CompareTag("Graspable"))\n        {\n            graspJoint.connectedBody = col.GetComponent<Rigidbody>();\n            isGrasping = true;\n        }\n    }\n\n    void OnTriggerExit(Collider col)\n    {\n        // Release when no longer in contact\n        if (isGrasping && col.CompareTag("Graspable"))\n        {\n            graspJoint.connectedBody = null;\n            isGrasping = false;\n        }\n    }\n}\n'})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"high-fidelity-rendering",children:"High-Fidelity Rendering"}),"\n",(0,s.jsx)(e.h3,{id:"hdrp-pipeline-setup",children:"HDRP Pipeline Setup"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Create HDRP Project"})," or ",(0,s.jsx)(e.strong,{children:"upgrade existing project"}),":","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:'Package Manager \u2192 Search "High Definition RP"'}),"\n",(0,s.jsx)(e.li,{children:"Install latest version"}),"\n",(0,s.jsx)(e.li,{children:"Create HDRP asset and set as default"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"hdrp-material-configuration",children:"HDRP Material Configuration"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-csharp",children:'// File: Assets/Scripts/HDRPMaterialSetup.cs\nusing UnityEngine;\nusing UnityEngine.Rendering.HighDefinition;\n\npublic class HDRPMaterialSetup : MonoBehaviour\n{\n    void SetupHDRPMaterial(Renderer rend, float metallic, float smoothness)\n    {\n        Material mat = rend.material;\n\n        // Base color\n        mat.SetColor("_BaseColor", new Color(0.7f, 0.7f, 0.7f, 1.0f));\n\n        // Metallic: 0=non-metal, 1=metal\n        mat.SetFloat("_Metallic", metallic);\n\n        // Smoothness: 0=rough, 1=glossy\n        mat.SetFloat("_Smoothness", smoothness);\n\n        // Normal map (if available)\n        // mat.SetTexture("_NormalMap", normalTexture);\n\n        // Ambient occlusion (for realism)\n        // mat.SetTexture("_AmbientOcclusionMap", aoTexture);\n    }\n\n    void Start()\n    {\n        // Configure humanoid materials\n        SetupHDRPMaterial(GetComponent<Renderer>(), 0.3f, 0.6f);  // Rubber-like\n\n        // Configure floor\n        Transform floor = transform.Find("Floor");\n        SetupHDRPMaterial(floor.GetComponent<Renderer>(), 0.1f, 0.3f);  // Concrete\n    }\n}\n'})}),"\n",(0,s.jsx)(e.h3,{id:"lighting-for-photorealism",children:"Lighting for Photorealism"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-csharp",children:'// File: Assets/Scripts/LightingSetup.cs\nusing UnityEngine;\n\npublic class LightingSetup : MonoBehaviour\n{\n    void Start()\n    {\n        // Directional light (sun)\n        GameObject sunGO = new GameObject("Sun");\n        Light sunLight = sunGO.AddComponent<Light>();\n        sunLight.type = LightType.Directional;\n        sunLight.intensity = 2.0f;\n        sunLight.colorTemperature = 6500f;  // Daylight\n        sunGO.transform.rotation = Quaternion.Euler(45, 0, 0);\n\n        // Point light (task light)\n        GameObject lampGO = new GameObject("TaskLight");\n        Light lamp = lampGO.AddComponent<Light>();\n        lamp.type = LightType.Point;\n        lamp.intensity = 1.5f;\n        lamp.range = 5.0f;\n        lampGO.transform.position = new Vector3(0, 2, 0);\n\n        // Environment: skybox for reflections\n        // (Set in Lighting settings \u2192 Skybox)\n    }\n}\n'})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"exporting-training-datasets",children:"Exporting Training Datasets"}),"\n",(0,s.jsx)(e.h3,{id:"ground-truth-annotation-format",children:"Ground Truth Annotation Format"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-json",children:'{\n  "frame_id": 0,\n  "timestamp": 1234567890.123,\n  "humanoid_pose": {\n    "position": [0.5, 0.0, 1.0],\n    "rotation_quaternion": [0, 0, 0, 1]\n  },\n  "camera": {\n    "intrinsics": {\n      "fx": 320.0,\n      "fy": 320.0,\n      "cx": 320.0,\n      "cy": 240.0\n    },\n    "pose": {\n      "position": [0, 0, 0],\n      "rotation": [0, 0, 0, 1]\n    }\n  },\n  "objects": [\n    {\n      "id": 1,\n      "name": "ball",\n      "pose": [1.0, 0, 0.5, 0, 0, 0, 1],\n      "bounding_box": [[100, 100], [200, 200]],\n      "segmentation_id": 42\n    }\n  ]\n}\n'})}),"\n",(0,s.jsx)(e.h3,{id:"dataset-exporter-script",children:"Dataset Exporter Script"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-csharp",children:'// File: Assets/Scripts/DatasetExporter.cs\nusing UnityEngine;\nusing System.IO;\nusing System.Collections.Generic;\n\npublic class DatasetExporter : MonoBehaviour\n{\n    public Camera captureCamera;\n    public int frameCount = 100;\n    public string outputPath = "Assets/GeneratedDataset/";\n\n    void Start()\n    {\n        if (!Directory.Exists(outputPath))\n            Directory.CreateDirectory(outputPath);\n\n        StartCoroutine(ExportFrames());\n    }\n\n    System.Collections.IEnumerator ExportFrames()\n    {\n        for (int i = 0; i < frameCount; i++)\n        {\n            // Capture RGB image\n            Texture2D screenshot = ScreenCapture.CaptureScreenshotAsTexture();\n            byte[] imageData = screenshot.EncodeToPNG();\n            File.WriteAllBytes($"{outputPath}/frame_{i:04d}.png", imageData);\n\n            // Generate ground truth annotation\n            Dictionary<string, object> annotation = new Dictionary<string, object>();\n            annotation["frame_id"] = i;\n            annotation["timestamp"] = Time.realtimeSinceStartup;\n\n            // Humanoid pose (would need to read from animator)\n            string jsonString = JsonUtility.ToJson(annotation);\n            File.WriteAllText($"{outputPath}/frame_{i:04d}_annotation.json", jsonString);\n\n            yield return new WaitForEndOfFrame();\n        }\n\n        Debug.Log($"Exported {frameCount} frames to {outputPath}");\n    }\n}\n'})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"domain-randomization",children:"Domain Randomization"}),"\n",(0,s.jsx)(e.p,{children:"Vary visual appearance to create robust datasets:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-csharp",children:'// File: Assets/Scripts/DomainRandomizer.cs\nusing UnityEngine;\n\npublic class DomainRandomizer : MonoBehaviour\n{\n    public void RandomizeScene()\n    {\n        // Randomize lighting\n        Light[] lights = FindObjectsOfType<Light>();\n        foreach (Light light in lights)\n        {\n            light.intensity = Random.Range(0.5f, 3.0f);\n            light.colorTemperature = Random.Range(3000f, 8000f);\n        }\n\n        // Randomize material colors\n        Renderer[] renderers = FindObjectsOfType<Renderer>();\n        foreach (Renderer rend in renderers)\n        {\n            Material mat = rend.material;\n            mat.SetColor("_BaseColor", Random.ColorHSV());\n        }\n\n        // Randomize camera position\n        Camera cam = GetComponent<Camera>();\n        float offset = Random.Range(-0.2f, 0.2f);\n        cam.transform.Translate(offset, offset, 0);\n    }\n}\n'})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"hands-on-labs",children:"Hands-On Labs"}),"\n",(0,s.jsx)(e.h3,{id:"lab-1-set-up-unity-ros-2-bridge",children:"Lab 1: Set Up Unity ROS 2 Bridge"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Objective"}),": Create ROS 2 \u2194 Unity communication and verify data flow."]}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Steps"}),":"]}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsx)(e.li,{children:"Create empty humanoid in Unity"}),"\n",(0,s.jsx)(e.li,{children:"Add ROS2Node component"}),"\n",(0,s.jsx)(e.li,{children:"Attach JointStatePublisher script"}),"\n",(0,s.jsxs)(e.li,{children:["Animate humanoid, monitor ROS 2 topic:","\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"ros2 topic echo /joint_states\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Verification"}),": Joint states appear in terminal"]}),"\n",(0,s.jsx)(e.h3,{id:"lab-2-import-humanoid-and-test-grasping",children:"Lab 2: Import Humanoid and Test Grasping"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Objective"}),": Import humanoid URDF, add grasping constraint, pick up object."]}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Steps"}),":"]}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsx)(e.li,{children:"Import humanoid.urdf into Unity"}),"\n",(0,s.jsx)(e.li,{children:"Add GraspController script to hand"}),"\n",(0,s.jsx)(e.li,{children:"Create graspable object (cube with Graspable tag)"}),"\n",(0,s.jsx)(e.li,{children:"Run simulation, move hand to touch object"}),"\n",(0,s.jsx)(e.li,{children:"Hand should grasp and move object"}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"lab-3-photorealistic-rendering-and-dataset-export",children:"Lab 3: Photorealistic Rendering and Dataset Export"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Objective"}),": Set up HDRP, render high-quality scene, export 100-frame dataset."]}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Steps"}),":"]}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsx)(e.li,{children:"Switch to HDRP pipeline"}),"\n",(0,s.jsx)(e.li,{children:"Configure materials and lighting"}),"\n",(0,s.jsx)(e.li,{children:"Attach DatasetExporter with DomainRandomizer"}),"\n",(0,s.jsxs)(e.li,{children:["Run and export frames:","\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"ls GeneratedDataset/frame_*.png | wc -l\n# Should show 100 files\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"end-of-chapter-exercises",children:"End-of-Chapter Exercises"}),"\n",(0,s.jsx)(e.h3,{id:"exercise-1-ros-2-communication-pipeline",children:"Exercise 1: ROS 2 Communication Pipeline"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Task"}),": Implement 2-way communication: send sine-wave joint commands from ROS 2 node, observe humanoid movement in Unity."]}),"\n",(0,s.jsx)(e.h3,{id:"exercise-2-grasping-evaluation",children:"Exercise 2: Grasping Evaluation"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Task"}),": Simulate picking up 5 different objects (varying mass 1-10kg), measure grasp success rate."]}),"\n",(0,s.jsx)(e.h3,{id:"exercise-3-rendering-quality-comparison",children:"Exercise 3: Rendering Quality Comparison"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Task"}),": Compare all 3 rendering pipelines (Built-in, URP, HDRP) on same scene. Document frame rates and visual quality."]}),"\n",(0,s.jsx)(e.h3,{id:"exercise-4-dataset-generation-and-validation",children:"Exercise 4: Dataset Generation and Validation"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Task"}),": Export 1000-frame dataset with domain randomization. Validate JSON annotations are syntactically correct."]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"summary",children:"Summary"}),"\n",(0,s.jsxs)(e.p,{children:["\u2705 ",(0,s.jsx)(e.strong,{children:"Why Unity"}),": Real-time rendering, training data, visualization"]}),"\n",(0,s.jsxs)(e.p,{children:["\u2705 ",(0,s.jsx)(e.strong,{children:"PhysX vs Gazebo"}),": Trade-offs between accuracy and speed"]}),"\n",(0,s.jsxs)(e.p,{children:["\u2705 ",(0,s.jsx)(e.strong,{children:"ros2cs communication"}),": C# ROS 2 integration for control"]}),"\n",(0,s.jsxs)(e.p,{children:["\u2705 ",(0,s.jsx)(e.strong,{children:"Humanoid import"}),": URDF to Unity with physics"]}),"\n",(0,s.jsxs)(e.p,{children:["\u2705 ",(0,s.jsx)(e.strong,{children:"Grasping"}),": D6 joint constraints for manipulation"]}),"\n",(0,s.jsxs)(e.p,{children:["\u2705 ",(0,s.jsx)(e.strong,{children:"Photorealistic rendering"}),": HDRP materials and lighting"]}),"\n",(0,s.jsxs)(e.p,{children:["\u2705 ",(0,s.jsx)(e.strong,{children:"Dataset export"}),": Ground truth annotations for ML training"]}),"\n",(0,s.jsxs)(e.p,{children:["\u2705 ",(0,s.jsx)(e.strong,{children:"Domain randomization"}),": Visual variety for robust models"]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"capstone-preparation",children:"Capstone Preparation"}),"\n",(0,s.jsx)(e.p,{children:"You've now completed:"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u2705 Chapter 1: Digital Twin concepts"}),"\n",(0,s.jsx)(e.li,{children:"\u2705 Chapter 2: Physics simulation (Gazebo)"}),"\n",(0,s.jsx)(e.li,{children:"\u2705 Chapter 3: Sensor simulation"}),"\n",(0,s.jsx)(e.li,{children:"\u2705 Chapter 4: High-fidelity rendering (Unity)"}),"\n"]}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Week 8 Capstone"}),": Combine all skills to simulate a humanoid completing a real task (walk, navigate, grasp, etc.) in both Gazebo and Unity."]}),"\n",(0,s.jsxs)(e.p,{children:["You're ready for ",(0,s.jsx)(e.a,{href:"/ai_native-textbook/docs/module-2/week-6",children:"Week 6 Practice Guide"})," and ",(0,s.jsx)(e.a,{href:"/ai_native-textbook/docs/module-2/week-7",children:"Week 7 Practice Guide"}),"!"]})]})}function h(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(c,{...n})}):c(n)}}}]);